---
layout: post
title: Начало цикла по kubernetes. Планирование. Настройка etcd.
---

Данной записью планирую открыть цикл статей по созданию кластера kubernetes с нуля (как говорят англоговорящие - from scratch).
В этотй записи будет описано планирование создание кластера.
Итак, в первую очередь определимся с количеством необходимых серверов. Я буду использовать 4 сервера для следующих ролей:
knode1 - master
knode2 - node
knode3 - node
knode4 - etcd

Каждая роль требует установки следующих компонент:
__Master__
* Kubernetes
  -  API Server
  -  Scheduler
  -  Controller Manager
* Flannel (опционально)
* iptables (предпочтительно минимум 1.4.11+)

__Nodes__
* Kubernetes
* Flannel daemon
* Docker (at least 1.6.2+ is preferred)
* iptables (at least 1.4.11+ is preferred)

__etcd__
* собственно сам etcd, который является хранилицем типа ключ-значение.

<!--
etcd, which is a distributed reliable key-value store for shared configurations and service discovery, is powered by CoreOS. 
The release page is https://github.com/coreos/etcd/releases. The prerequisite we need is just the etcd package.
Итак, сначала поднимаем etcd как хранилище данных
Я это буду делать на сервере с hostname - knode4


Нужно понимать, что сейчас есть много установщиков kubernetes кластера, которые позволяют упростить развертывание кластера.
Например rancher 2.0 позволяет создать свой кластер очень просто.
Для начала нужно определиться, где будем разворачивать кластер. Будет ли это облачная среда, такая как azure или aws или google cloud, или же это будут наши on-permises сервера. Можно использовать как bare-metal сервера в качестве нод кластера, так и виртуальным машины.
Я буду разворачивать кластера на двух VM, развернутых и работающих в VMWare  vShere.
Список доступный установщиков есть здесь и здесь.
Моя цель - понять как работает клатер изнутри, пощупать существующие элементы, поэтому я решил пойти по самому сложному, но в тоже время и самому познавательному, пути - деплой кластера с нуля (from scratch). Данная процедура описана по этой сслыке, ей я и буду следовать. А все проблемы, которые будут возникать, опишу здесь.

-->

Сначала отключим selinux (переведем в permessive mode) и iptdables, что бы мы не искали проблем в отсутствии сетевых связностей.
Нам требуется 4 сервера:
* master
* etcd
* 2 nodes



